library(tsoutliers)
apply(resi,MARGIN=2,jarque.bera.test)
#$A

#Jarque Bera Test

#data:  newX[, i]
#X-squared = 1470.9, df = 2, p-value < 2.2e-16


#$B

#Jarque Bera Test

#data:  newX[, i]
#X-squared = 470.07, df = 2, p-value < 2.2e-16


#$C

#Jarque Bera Test

#data:  newX[, i]
#X-squared = 143.92, df = 2, p-value < 2.2e-16


#$D

#Jarque Bera Test

#data:  newX[, i]
#X-squared = 107.46, df = 2, p-value < 2.2e-16


###DBEKK-GED results estimated using the RATS 10.1
###Symmetric DBEKK
C = A = G = matrix(0,4,4)
#5.  C(1,1)                        0.001226529  0.000282808      4.33697  0.00001445
#6.  C(2,1)                        0.000177402  0.000200618      0.88428  0.37654610
#7.  C(2,2)                        0.000821450  0.000287167      2.86053  0.00422930
#8.  C(3,1)                       -0.004195497  0.004569177     -0.91822  0.35850517
#9.  C(3,2)                        0.003136059  0.007600593      0.41261  0.67989445
#10. C(3,3)                        0.045202871  0.007653577      5.90611  0.00000000
#11. C(4,1)                        0.061637773  0.099707630      0.61819  0.53645332
#12. C(4,2)                       -0.043046184  0.205382763     -0.20959  0.83398764
#13. C(4,3)                       -0.040381911  0.050143961     -0.80532  0.42063531
#14. C(4,4)                        0.801885835  0.151965286      5.27677  0.00000013
#15. A(1)                         -0.232833744  0.026770721     -8.69733  0.00000000
#16. A(2)                          0.114719854  0.018460595      6.21431  0.00000000
#17. A(3)                          0.154532659  0.030486028      5.06897  0.00000040
#18. A(4)                         -0.237375537  0.038313845     -6.19556  0.00000000
#19. B(1)                          0.868542636  0.021563618     40.27815  0.00000000
#20. B(2)                          0.961099936  0.009753668     98.53729  0.00000000
#21. B(3)                          0.723807157  0.083676114      8.65010  0.00000000
#22. B(4)                          0.374936720  0.319777952      1.17249  0.24100005
C[1,1]=                        0.001226529 
C[2,1]=                        0.000177402 
C[2,2]=                        0.000821450 
C[3,1]=                       -0.004195497 
C[3,2]=                        0.003136059 
C[3,3]=                        0.045202871 
C[4,1]=                        0.061637773 
C[4,2]=                       -0.043046184
C[4,3]=                       -0.040381911
C[4,4]=                        0.801885835
A[1,1]=                       -0.232833744
A[2,2]=                        0.114719854
A[3,3]=                        0.154532659
A[4,4]=                       -0.237375537
G[1,1]=                        0.868542636
G[2,2]=                        0.961099936
G[3,3]=                        0.723807157
G[4,4]=                        0.374936720

####Symmetric DBEKK-GED stationarity
max(eigen(kronecker(A,A) + kronecker(G,G))$values)<1

###Asymmetric DBEKK
C = A = G = B = matrix(0,4,4)
#1.  C(1,1)                        0.001624812  0.000102562     15.84232  0.00000000
#2.  C(2,1)                        0.000247094  0.000177994      1.38821  0.16507310
#3.  C(2,2)                        0.001039957  0.000281376      3.69597  0.00021905
#4.  C(3,1)                       -0.004406663  0.004997008     -0.88186  0.37785236
#5.  C(3,2)                        0.004036055  0.008104029      0.49803  0.61846240
#6.  C(3,3)                        0.050258958  0.005609401      8.95977  0.00000000
#7.  C(4,1)                        0.054318351  0.037529302      1.44736  0.14779656
#8.  C(4,2)                       -0.062671277  0.059714418     -1.04952  0.29394039
#9.  C(4,3)                       -0.003393104  0.026663710     -0.12726  0.89873818
#10. C(4,4)                        0.250542801  0.033162335      7.55504  0.00000000
#11. A(1)                          0.223232654  0.011132889     20.05164  0.00000000
#12. A(2)                         -0.130780791  0.019570982     -6.68238  0.00000000
#13. A(3)                         -0.167199269  0.024777276     -6.74809  0.00000000
#14. A(4)                          0.096194154  0.019695238      4.88413  0.00000104
#15. B(1)                          0.850593849  0.012619995     67.40049  0.00000000
#16. B(2)                          0.952889968  0.009065245    105.11464  0.00000000
#17. B(3)                          0.687092010  0.044767440     15.34803  0.00000000
#18. B(4)                          0.884614506  0.005972300    148.11956  0.00000000
#19. D(1)                         -0.150347697  0.030085951     -4.99727  0.00000058
#20. D(2)                          0.030502270  0.042586954      0.71624  0.47384621
#21. D(3)                         -0.064325173  0.069793959     -0.92164  0.35671438
#22. D(4)                          0.251717483  0.022796248     11.04206  0.00000000
C[1,1]=                        0.001624812 
C[2,1]=                        0.000247094 
C[2,2]=                        0.001039957 
C[3,1]=                       -0.004406663 
C[3,2]=                        0.004036055
C[3,3]=                        0.050258958
C[4,1]=                        0.054318351
C[4,2]=                       -0.062671277
C[4,3]=                       -0.003393104
C[4,4]=                        0.250542801
A[1,1]=                          0.223232654
A[2,2]=                         -0.130780791
A[3,3]=                         -0.167199269
A[4,4]=                          0.096194154
G[1,1]=                          0.850593849
G[2,2]=                          0.952889968
G[3,3]=                          0.687092010
G[4,4]=                          0.884614506
B[1,1]=                         -0.150347697
B[2,2]=                          0.030502270
B[3,3]=                         -0.064325173
B[4,4]=                          0.251717483
signs = as.matrix(rep(-1,N))
####Asymmetric DBEKK-GED stationarity
max(eigen(kronecker(A,A) + expected_indicator_value(resi,signs) * kronecker(B,B) + kronecker(G,G))$values)<1

